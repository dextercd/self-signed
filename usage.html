<!doctype html>

<html lang="en">

<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="How to use the certificates generated by this tool. Configure the client to trust the CA certificate and have the server present its leaf certificate.">

<title>Self-signed certificate</title>

<style>pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs-comment,.hljs-quote{color:#969896}.hljs-variable,.hljs-template-variable,.hljs-tag,.hljs-name,.hljs-selector-id,.hljs-selector-class,.hljs-regexp,.hljs-deletion{color:#d54e53}.hljs-number,.hljs-built_in,.hljs-literal,.hljs-type,.hljs-params,.hljs-meta,.hljs-link{color:#e78c45}.hljs-attribute{color:#e7c547}.hljs-string,.hljs-symbol,.hljs-bullet,.hljs-addition{color:#b9ca4a}.hljs-title,.hljs-section{color:#7aa6da}.hljs-keyword,.hljs-selector-tag{color:#c397d8}.hljs{background:#000;color:#eaeaea}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}*,:before,:after{box-sizing:border-box}body,html{margin:0}html{background-color:#881335;color:#f2f2f2;font-family:sans-serif}#root{display:flex;min-height:100vh;flex-direction:column}#app{align-self:center;max-width:675px;width:100%;padding:0 5px 20px;flex:1}.doc{align-self:center;max-width:780px;width:100%;padding:0 5px 20px;margin:10px 0;flex:1;background-color:#671028;border:1px solid black}@media (max-width: 780px){.doc{border-left:0px;border-right:0px}}footer{min-height:3em;display:flex;justify-content:center;align-items:center;background-color:#111}footer a{color:inherit}a{color:#ff76d0;text-decoration:underline 1px}br-{white-space:nowrap;-webkit-hyphens:none;hyphens:none}fieldset{padding:0;margin:0;border:none}.fields{width:100%;display:flex;flex-direction:row;column-gap:10px;flex-wrap:wrap;margin-bottom:10px}.field{margin-bottom:10px}.field>*{display:block;width:100%}.field>input[type=datetime-local]{width:auto}.field>.fields{padding-left:15px;display:flex}.fields>.field{margin-bottom:0;flex:1}.checkbox-list{padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;min-width:250px}.lower-case{text-transform:lowercase}summary{margin:1em 0;-webkit-user-select:none;user-select:none}p.warning{padding-left:4px;border-left:6px solid #ff5;color:#ff5}p.warning:before{content:"⚠️ Warning: "}p.error{padding:4px;border-left:6px solid #d61703;color:#000;background-color:#fff}p.error:before{content:"⚠️ Error: "}.top-bar{background-color:#111;padding:10px 20px 0}.top-bar nav>a{display:inline-block;padding:10px 1em}.top-bar nav>a[data-active]{background:#fff;color:#333;text-decoration:none}.tabbar{position:relative;z-index:10}.tabbar>button{color:inherit;background-color:#5f1d30;padding:5px 10px;border:1px solid black;border-bottom-width:0px;border-right-width:0px;font-size:1.2em}.tabbar>button:last-child{border-right-width:1px}.tabbar>button[data-active=true]{background-color:#b7264f;position:relative;padding-bottom:6px;margin-bottom:-1px}.tabcontent{border:1px solid black;padding:10px;min-height:6em;background-color:#b7264f}</style>


<section id="root">

    <div class="top-bar">
        <h1>Make Self-Signed Certificate</h1>


        <nav>
            <a href=".">App</a>
            <a href="" data-active>Usage</a>
            <a href="about">About</a>
        </nav>

    </div>

<main class="doc"><h1>Usage</h1>
<p>In its default configuration, this web app will give you a ZIP file containing
a self-signed root/CA certificate and an end/leaf certificate signed by the CA certificate.
You also get the corresponding private keys.</p>
<p>The CA certificate is what should be trusted by your client software.
Most software relies on your OS' trust store but may have alternative ways to trust certificates.
Some software, notably Firefox, has its own trust store and does not use your operating system's by default.</p>
<p>The end/leaf certificate is what has to be presented to the client by your server software.
Your client will verify that it's signed by a trusted CA certificate and gives an error if it isn't.</p>
<h2>Trusting the CA certificate</h2>
<p>You likely want your client software to trust the CA certificate so you don't get security errors when using your dev site.
Your client in this case could be a web browser or something else such as a program calling your REST API.</p>
<p>You should do some web searches or consult your client, library, or browser documentation to figure out how to do this.
This page lists some methods for popular software.</p>
<h3>Operating Systems</h3>
<ul>
<li>Arch Linux: <a href="https://wiki.archlinux.org/title/Transport_Layer_Security#Add_a_certificate_to_a_trust_store">Use the <code><br->trust</br-></code> program</a>.</li>
<li>Windows: <a href="https://superuser.com/a/467322">https://superuser.com/a/467322</a></li>
<li>macOS:
<ul>
<li>First <a href="https://support.apple.com/en-gb/guide/keychain-access/kyca2431/mac">import the certificate</a>
into your keychain then
<a href="https://support.apple.com/en-gb/guide/keychain-access/kyca11871/mac">adjust its trust settings</a>.</li>
</ul>
</li>
</ul>
<h3>Browsers</h3>
<ul>
<li>Firefox:
<ul>
<li>Go to Settings &gt; Privacy &amp; Security &gt; Security &gt; View Certificates:
<ul>
<li>Swap to the Authorities tab and import the certificate. Make sure to check the &quot;Trust this CA to identify websites&quot; option.</li>
</ul>
</li>
<li>You can also make Firefox use your OS trust store through the
<a href="https://support.mozilla.org/en-US/kb/setting-certificate-authorities-firefox"><code><br->security.enterprise_roots.enabled</br-></code> option</a>.</li>
</ul>
</li>
<li>Chrome:
<ul>
<li>Chrome on Windows uses your OS trust store. On Linux, it depends on your distribution.</li>
<li>On Linux, Chrome also checks a separate trust store in your home directory.
You can choose to add your certificate just here instead of system wide.<br>
Go to Settings &gt; Privacy and Security &gt; Security &gt; Manage certificates:
<ul>
<li>Swap to the Authorities tab and import the certificate. Make sure to check the &quot;Trust this certificate for identifying websites&quot; option.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>HTTP Clients</h3>
<ul>
<li>cURL:
<ul>
<li>cURL normally uses your system's trust store, but
some installations require the <a href="https://curl.se/docs/manpage.html#--ca-native"><code><br->--ca-native</br-></code></a> option to do so.</li>
<li>You can use the command line option <code><br->--cacert</br-> <br->path/to/ca_cert.crt</br-></code> to
trust the certificate for a single invocation.</li>
<li><a href="https://curl.se/docs/sslcerts.html">https://curl.se/docs/sslcerts.html</a></li>
<li><a href="https://curl.se/libcurl/c/CURLOPT_CAINFO.html"><code><br->CURLOPT_CAINFO</br-></code></a></li>
</ul>
</li>
<li>Python requests:
<ul>
<li>The requests package uses the <a href="https://certifiio.readthedocs.io/en/latest/"><code><br->certifi</br-></code></a> library,
it <a href="https://github.com/psf/requests/issues/2966">does not</a> use your operating system's trust store by default.</li>
<li>There are <a href="https://docs.python-requests.org/en/latest/user/advanced/#ssl-cert-verification">several options available</a>
to make requests trust your certificate.
You change the code or set the <code><br->REQUESTS_CA_BUNDLE</br-></code> environment variable.</li>
</ul>
</li>
<li>OpenSSL:
<ul>
<li><code><br->openssl</br-> <br->s_client</br-> <br->-verify_return_error</br-> <br->-verifyCAfile</br-> <br->path/to/ca_cert.crt</br-> <br->-crlf</br-> <br->-connect</br-> <br->localhost:443</br-></code></li>
</ul>
</li>
<li>Postman:
<ul>
<li><a href="https://learning.postman.com/docs/sending-requests/authorization/certificates/">Documentation</a></li>
</ul>
</li>
</ul>
<h2>Configuring the HTTP server</h2>
<p>This is where you'll use the <br->[domain name].crt</br-> and <br->[domain name].key</br-> files.</p>
<h3>NGINX</h3>
<p>See the <a href="https://nginx.org/en/docs/http/configuring_https_servers.html">official documentation here</a>, but
the gist is this:</p>
<pre><code class="hljs"><span class="hljs-section">server</span> {
    <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl;
    <span class="hljs-attribute">server_name</span> [domain name];
    <span class="hljs-attribute">ssl_certificate</span> path/to/[domain name].crt;
    <span class="hljs-attribute">ssl_certificate_key</span> path/to/[domain name].key;
    <span class="hljs-attribute">ssl_protocols</span> TLSv1.<span class="hljs-number">2</span> TLSv1.<span class="hljs-number">3</span>;
    <span class="hljs-attribute">ssl_ciphers</span> HIGH:!aNULL:!MD5;

    <span class="hljs-comment"># ...</span>
}
</code></pre>
<h3>Apache HTTP Server</h3>
<p>Checkout the <a href="https://httpd.apache.org/docs/current/ssl/ssl_howto.html">official documentation here</a>.</p>
<pre><code class="hljs"><span class="hljs-comment"># /usr/local/apache2/conf/httpd.conf</span>

<span class="hljs-comment"># ...</span>

<span class="hljs-attribute">LoadModule</span> socache_shmcb_module modules/mod_socache_shmcb.so
<span class="hljs-attribute">LoadModule</span> ssl_module modules/mod_ssl.so

<span class="hljs-comment"># Secure (SSL/TLS) connections</span>
<span class="hljs-attribute">Include</span> conf/extra/httpd-ssl.conf

<span class="hljs-comment"># ...</span>
</code></pre>
<pre><code class="hljs"><span class="hljs-comment"># /usr/local/apache2/conf/extra/httpd-ssl.conf</span>

<span class="hljs-comment"># ...</span>

<span class="hljs-attribute">SSLCertificateFile</span> <span class="hljs-string">&quot;path/to/[domain name].crt&quot;</span>
<span class="hljs-attribute">SSLCertificateKeyFile</span> <span class="hljs-string">&quot;path/to/[domain name].key&quot;</span>

<span class="hljs-comment"># ...</span>
</code></pre>
<h3>Caddy</h3>
<p>See the full documentation for the <a href="https://caddyserver.com/docs/caddyfile/directives/tls"><code><br->tls</br-></code> directive</a>.</p>
<pre><code class="hljs"><span class="hljs-section">[domain name]</span> {
    <span class="hljs-attribute">tls</span> <span class="hljs-string">"path/to/[domain name].crt"</span> <span class="hljs-string">"path/to/[domain name].key"</span>

    <span class="hljs-comment"># ...</span>
}</code></pre>
<h3>HAProxy</h3>
<p>For more details, see the <a href="https://www.haproxy.com/documentation/haproxy-configuration-tutorials/ssl-tls/">HAProxy TLS Documentation</a>.</p>
<p>For HAProxy, you must combine the certificate and key into one file with the key
coming last. On a Unix-like environment, you can do that with the following command:</p>
<pre><code class="hljs">$ <span class="hljs-built_in">cat</span> <span class="hljs-string">&quot;path/to/[domain name].crt&quot;</span> <span class="hljs-string">&quot;path/to/[domain name].key&quot;</span> &gt;<span class="hljs-string">&quot;path/to/[domain name].combined.crt&quot;</span>
</code></pre>
<pre><code class="hljs"><span class="hljs-comment"># ...</span>

<span class="hljs-attribute">frontend</span> www
    <span class="hljs-attribute">bind</span> :<span class="hljs-number">80</span>
    <span class="hljs-attribute">bind</span> :<span class="hljs-number">443</span> ssl crt path/to/[domain name].combined.crt

    <span class="hljs-attribute">http</span>-request redirect scheme https unless { ssl_fc }

    <span class="hljs-comment"># ...</span>
</code></pre>
<h3>Lighttpd</h3>
<p><a href="https://redmine.lighttpd.net/projects/lighttpd/wiki/Docs_SSL">Lighttpd TLS documentation</a>.</p>
<pre><code class="hljs"><span class="hljs-comment"># ...</span>

server.modules += (<span class="hljs-string">&quot;mod_openssl&quot;</span>)
<span class="hljs-variable">$SERVER</span>[<span class="hljs-string">&quot;socket&quot;</span>] == <span class="hljs-string">&quot;:443&quot;</span> {
    ssl.engine = <span class="hljs-string">&quot;enable&quot;</span>
    ssl.pemfile = <span class="hljs-string">&quot;path/to/[domain name].crt&quot;</span>
    ssl.privkey = <span class="hljs-string">&quot;path/to/[domain name].key&quot;</span>
}
</code></pre>
<h3>NPM http-server</h3>
<p>See all <a href="https://github.com/http-party/http-server#available-options">available run options</a>.</p>
<pre><code class="hljs">$ npx http-server --tls --cert <span class="hljs-string">&quot;path/to/[domain name].crt&quot;</span> --key <span class="hljs-string">&quot;path/to/[domain name].key&quot;</span> dist/
</code></pre>
<h3>Node.js</h3>
<p>Also see the <a href="https://nodejs.org/api/https.html#httpscreateserveroptions-requestlistener">official documentation</a>.</p>
<pre><code class="hljs"><span class="hljs-keyword">const</span> https = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;node:https&#x27;</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;node:fs&#x27;</span>);

<span class="hljs-keyword">const</span> options = {
    <span class="hljs-attr">cert</span>: fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&#x27;path/to/[domain name].crt&#x27;</span>),
    <span class="hljs-attr">key</span>: fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&#x27;path/to/[domain name].key&#x27;</span>),
};

https.<span class="hljs-title function_">createServer</span>(options, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>);
    res.<span class="hljs-title function_">end</span>(<span class="hljs-string">&#x27;hello world\n&#x27;</span>);
}).<span class="hljs-title function_">listen</span>(<span class="hljs-number">443</span>); 
</code></pre>
<h3>Cowboy</h3>
<p>Use <a href="https://ninenines.eu/docs/en/cowboy/2.12/manual/cowboy.start_tls/"><code><br->cowboy:start_tls/3</br-></code></a> along with the <code><br->certfile</br-></code> and <code><br->keyfile</br-></code> <a href="https://ninenines.eu/docs/en/ranch/2.1/manual/ranch_ssl/#_ssl_opt"><code><br->ranch_ssl:opts()</br-></code> options</a>.</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-title">start</span><span class="hljs-params">(_StartType, _StartArgs)</span> -&gt;</span>
    Dispatch = cowboy_router:compile([
        {&#x27;_&#x27;, [{<span class="hljs-string">&quot;/&quot;</span>, hello_handler, []}]}
    ]),
    {ok, _} = cowboy:start_tls(my_https_listener,
        [{port, <span class="hljs-number">443</span>},
         {certfile, <span class="hljs-string">&quot;path/to/[domain name].crt&quot;</span>},
         {keyfile, <span class="hljs-string">&quot;path/to/[domain name].key&quot;</span>}],
        #{env =&gt; #{dispatch =&gt; Dispatch}}
    ),
    tls_example_sup:start_link().
</code></pre>
<h3>Kestrel</h3>
<p>See the <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/kestrel/endpoints#configure-https">Kestrel Endpoint configuration</a> docs.</p>
<p>Add something like the following into your <code><br->appsettings.json</br-></code>:</p>
<pre><code class="hljs"><span class="hljs-punctuation">{</span>
  <span class="hljs-comment">// ...</span>

  <span class="hljs-attr">&quot;Kestrel&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;Endpoints&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;Https&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;Url&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;https://localhost:443&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;Certificate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">&quot;Path&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;path/to/[domain name].crt&quot;</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">&quot;KeyPath&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;path/to/[domain name].key&quot;</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3>Gunicorn</h3>
<p>Gunicorn <a href="https://docs.gunicorn.org/en/stable/settings.html#ssl">SSL settings</a>.</p>
<p>There are various ways to configure Gunicorn; this example uses the command line:</p>
<pre><code class="hljs">gunicorn                                   \
    --<span class="hljs-built_in">bind</span> :443                            \
    --certfile <span class="hljs-string">&quot;path/to/[domain name].crt&quot;</span> \
    --keyfile <span class="hljs-string">&quot;path/to/[domain name].key&quot;</span>  \
    app:app
</code></pre>
<h3>Uvicorn</h3>
<p>Uvicorn <a href="https://www.uvicorn.org/settings/#https">HTTPS settings</a>.</p>
<pre><code class="hljs">uvicorn                                        \
    --port 443                                 \
    --ssl-certfile=<span class="hljs-string">&quot;path/to/[domain name].crt&quot;</span> \
    --ssl-keyfile=<span class="hljs-string">&quot;path/to/[domain name].key&quot;</span>  \
    app:app
</code></pre>
<h3>uWSGI</h3>
<p>uWSGI <a href="https://uwsgi-docs.readthedocs.io/en/latest/HTTPS.html">HTTPS support</a>.</p>
<pre><code class="hljs">uwsgi \
    --https <span class="hljs-string">&quot;0.0.0.0:443,path/to/[domain name].crt,path/to/[domain name].key,HIGH&quot;</span> \
    --wsgi-file app.py
</code></pre>
</main>

    <footer><div>Copyright <a href="mailto:dexter.c.dopping@gmail.com">Dexter Döpping</a></div></footer>
</section>

</html>
